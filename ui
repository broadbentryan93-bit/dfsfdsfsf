-- HI Library v2.0
-- Enhanced with Tab Movement on Right Shift
-- Modern Roblox UI Library with position toggle feature

local HI = {}
HI.__index = HI

-- Color Schemes
HI.ColorSchemes = {
    Dark = {
        Main = Color3.fromRGB(28, 28, 33),
        Secondary = Color3.fromRGB(38, 38, 43),
        Tertiary = Color3.fromRGB(48, 48, 53),
        Accent = Color3.fromRGB(0, 122, 204),
        Text = Color3.fromRGB(240, 240, 240),
        SubText = Color3.fromRGB(180, 180, 180),
        Border = Color3.fromRGB(58, 58, 63),
        Success = Color3.fromRGB(0, 200, 83),
        Warning = Color3.fromRGB(255, 136, 0),
        Danger = Color3.fromRGB(232, 17, 35)
    },
    Light = {
        Main = Color3.fromRGB(245, 245, 245),
        Secondary = Color3.fromRGB(235, 235, 235),
        Tertiary = Color3.fromRGB(225, 225, 225),
        Accent = Color3.fromRGB(0, 122, 204),
        Text = Color3.fromRGB(30, 30, 30),
        SubText = Color3.fromRGB(100, 100, 100),
        Border = Color3.fromRGB(210, 210, 210),
        Success = Color3.fromRGB(0, 200, 83),
        Warning = Color3.fromRGB(255, 136, 0),
        Danger = Color3.fromRGB(232, 17, 35)
    }
}

-- Default Configuration
HI.Config = {
    Theme = "Dark",
    Font = Enum.Font.Gotham,
    TextSize = 12,
    TitleSize = 14,
    BorderSize = 1,
    AnimationSpeed = 0.15,
    TabWidth = 380,
    TabHeight = 500
}

-- Utility Functions
local function Tween(Object, Properties, Duration)
    Duration = Duration or HI.Config.AnimationSpeed
    local TweenService = game:GetService("TweenService")
    local TweenInfo = TweenInfo.new(Duration, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local Tween = TweenService:Create(Object, TweenInfo, Properties)
    Tween:Play()
    return Tween
end

local function Round(Number, DecimalPlaces)
    DecimalPlaces = DecimalPlaces or 0
    local Multiplier = 10 ^ DecimalPlaces
    return math.floor(Number * Multiplier + 0.5) / Multiplier
end

-- Main Library Class
function HI.new(Title)
    local self = setmetatable({}, HI)
    
    -- Window Positions
    self.Positions = {
        Left = UDim2.new(0.5, -HI.Config.TabWidth/2, 0.5, -HI.Config.TabHeight/2), -- Center
        Right = UDim2.new(1, -HI.Config.TabWidth - 20, 0.5, -HI.Config.TabHeight/2) -- Right side
    }
    self.CurrentPosition = "Left"
    
    -- Create ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "HILibrary"
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.DisplayOrder = 999
    self.ScreenGui.ResetOnSpawn = false
    
    -- Main Window
    self.MainWindow = Instance.new("Frame")
    self.MainWindow.Name = "MainWindow"
    self.MainWindow.Size = UDim2.new(0, HI.Config.TabWidth, 0, HI.Config.TabHeight)
    self.MainWindow.Position = self.Positions.Left
    self.MainWindow.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Main
    self.MainWindow.BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    self.MainWindow.BorderSizePixel = HI.Config.BorderSize
    self.MainWindow.ClipsDescendants = true
    self.MainWindow.Parent = self.ScreenGui
    
    -- Make Window Draggable
    self:Draggify(self.MainWindow)
    
    -- Title Bar with Tab Indicator
    self.TitleBar = Instance.new("Frame")
    self.TitleBar.Name = "TitleBar"
    self.TitleBar.Size = UDim2.new(1, 0, 0, 35)
    self.TitleBar.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Secondary
    self.TitleBar.BorderSizePixel = 0
    self.TitleBar.Parent = self.MainWindow
    
    local TitleContainer = Instance.new("Frame")
    TitleContainer.Name = "TitleContainer"
    TitleContainer.Size = UDim2.new(1, -80, 1, 0)
    TitleContainer.BackgroundTransparency = 1
    TitleContainer.Position = UDim2.new(0, 10, 0, 0)
    TitleContainer.Parent = self.TitleBar
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Name = "Title"
    TitleLabel.Size = UDim2.new(1, 0, 1, 0)
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Text = Title or "HI Library"
    TitleLabel.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    TitleLabel.Font = Enum.Font.GothamSemibold
    TitleLabel.TextSize = HI.Config.TitleSize
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.Parent = TitleContainer
    
    local PositionIndicator = Instance.new("TextLabel")
    self.PositionIndicator = PositionIndicator
    PositionIndicator.Name = "PositionIndicator"
    PositionIndicator.Size = UDim2.new(0, 100, 0, 15)
    PositionIndicator.Position = UDim2.new(0, 0, 1, -15)
    PositionIndicator.BackgroundTransparency = 1
    PositionIndicator.Text = "[Left Side]"
    PositionIndicator.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    PositionIndicator.Font = Enum.Font.Gotham
    PositionIndicator.TextSize = 10
    PositionIndicator.TextTransparency = 0.7
    PositionIndicator.Parent = TitleContainer
    
    -- Close Button
    self.CloseButton = Instance.new("TextButton")
    self.CloseButton.Name = "CloseButton"
    self.CloseButton.Size = UDim2.new(0, 35, 1, 0)
    self.CloseButton.Position = UDim2.new(1, -35, 0, 0)
    self.CloseButton.BackgroundTransparency = 1
    self.CloseButton.Text = "×"
    self.CloseButton.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    self.CloseButton.Font = Enum.Font.GothamBold
    self.CloseButton.TextSize = 18
    self.CloseButton.Parent = self.TitleBar
    
    self.CloseButton.MouseEnter:Connect(function()
        Tween(self.CloseButton, {TextColor3 = HI.ColorSchemes[HI.Config.Theme].Danger})
    end)
    
    self.CloseButton.MouseLeave:Connect(function()
        Tween(self.CloseButton, {TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText})
    end)
    
    -- Tabs Container (like your image - horizontal at top)
    self.TabsContainer = Instance.new("Frame")
    self.TabsContainer.Name = "TabsContainer"
    self.TabsContainer.Size = UDim2.new(1, -20, 0, 28)
    self.TabsContainer.Position = UDim2.new(0, 10, 0, 40)
    self.TabsContainer.BackgroundTransparency = 1
    self.TabsContainer.Parent = self.MainWindow
    
    local TabsListLayout = Instance.new("UIListLayout")
    TabsListLayout.FillDirection = Enum.FillDirection.Horizontal
    TabsListLayout.Padding = UDim.new(0, 5)
    TabsListLayout.Parent = self.TabsContainer
    
    -- Content Area
    self.ContentContainer = Instance.new("Frame")
    self.ContentContainer.Name = "ContentContainer"
    self.ContentContainer.Size = UDim2.new(1, -20, 1, -80)
    self.ContentContainer.Position = UDim2.new(0, 10, 0, 73)
    self.ContentContainer.BackgroundTransparency = 1
    self.ContentContainer.Parent = self.MainWindow
    
    -- Scrolling Frame for Content
    self.ContentScroller = Instance.new("ScrollingFrame")
    self.ContentScroller.Name = "ContentScroller"
    self.ContentScroller.Size = UDim2.new(1, 0, 1, 0)
    self.ContentScroller.BackgroundTransparency = 1
    self.ContentScroller.BorderSizePixel = 0
    self.ContentScroller.ScrollBarThickness = 4
    self.ContentScroller.ScrollBarImageColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    self.ContentScroller.AutomaticCanvasSize = Enum.AutomaticSize.Y
    self.ContentScroller.CanvasSize = UDim2.new(0, 0, 0, 0)
    self.ContentScroller.Parent = self.ContentContainer
    
    local ContentListLayout = Instance.new("UIListLayout")
    ContentListLayout.Padding = UDim.new(0, 15)
    ContentListLayout.Parent = self.ContentScroller
    
    -- Watermark
    self.Watermark = Instance.new("TextLabel")
    self.Watermark.Name = "Watermark"
    self.Watermark.Size = UDim2.new(1, 0, 0, 20)
    self.Watermark.Position = UDim2.new(0, 0, 1, -25)
    self.Watermark.BackgroundTransparency = 1
    self.Watermark.Text = "HI Library v2.0 • RightShift: Move Tab"
    self.Watermark.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    self.Watermark.Font = Enum.Font.Gotham
    self.Watermark.TextSize = 10
    self.Watermark.TextTransparency = 0.5
    self.Watermark.Parent = self.MainWindow
    
    -- State Management
    self.Tabs = {}
    self.Sections = {}
    self.CurrentTab = nil
    self.Open = true
    
    -- Close Button Functionality
    self.CloseButton.MouseButton1Click:Connect(function()
        self:Toggle()
    end)
    
    -- Right Shift Toggle Position
    self:SetupPositionToggle()
    
    return self
end

-- Setup Right Shift Position Toggle
function HI:SetupPositionToggle()
    local UserInputService = game:GetService("UserInputService")
    
    UserInputService.InputBegan:Connect(function(Input, Processed)
        if not Processed and Input.KeyCode == Enum.KeyCode.RightShift then
            self:TogglePosition()
        end
    end)
end

-- Toggle Window Position
function HI:TogglePosition()
    if self.CurrentPosition == "Left" then
        self.CurrentPosition = "Right"
        self.PositionIndicator.Text = "[Right Side]"
        Tween(self.MainWindow, {Position = self.Positions.Right})
    else
        self.CurrentPosition = "Left"
        self.PositionIndicator.Text = "[Left Side]"
        Tween(self.MainWindow, {Position = self.Positions.Left})
    end
end

-- Make Window Draggable
function HI:Draggify(Frame)
    local Dragging, DragInput, DragStart, StartPos
    
    local function Update(Input)
        local Delta = Input.Position - DragStart
        Frame.Position = UDim2.new(StartPos.X.Scale, StartPos.X.Offset + Delta.X, StartPos.Y.Scale, StartPos.Y.Offset + Delta.Y)
    end
    
    Frame.InputBegan:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true
            DragStart = Input.Position
            StartPos = Frame.Position
            
            Input.Changed:Connect(function()
                if Input.UserInputState == Enum.UserInputState.End then
                    Dragging = false
                end
            end)
        end
    end)
    
    Frame.InputChanged:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseMovement then
            DragInput = Input
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(Input)
        if Input == DragInput and Dragging then
            Update(Input)
        end
    end)
end

-- Toggle UI Visibility
function HI:Toggle()
    self.Open = not self.Open
    self.ScreenGui.Enabled = self.Open
end

-- Set Theme
function HI:SetTheme(ThemeName)
    if HI.ColorSchemes[ThemeName] then
        HI.Config.Theme = ThemeName
        self:UpdateTheme()
    end
end

function HI:UpdateTheme()
    local Theme = HI.ColorSchemes[HI.Config.Theme]
    Tween(self.MainWindow, {BackgroundColor3 = Theme.Main, BorderColor3 = Theme.Border})
    Tween(self.TitleBar, {BackgroundColor3 = Theme.Secondary})
end

-- Tab System (matching your image style)
function HI:NewTab(TabName)
    local Tab = {}
    
    -- Tab Button (compact like your image)
    Tab.Button = Instance.new("TextButton")
    Tab.Button.Name = TabName .. "Tab"
    Tab.Button.Size = UDim2.new(0, 70, 1, 0)
    Tab.Button.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary
    Tab.Button.BorderSizePixel = 0
    Tab.Button.Text = TabName
    Tab.Button.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    Tab.Button.Font = Enum.Font.Gotham
    Tab.Button.TextSize = 12
    Tab.Button.Parent = self.TabsContainer
    
    -- Tab Content
    Tab.Content = Instance.new("Frame")
    Tab.Content.Name = TabName .. "Content"
    Tab.Content.Size = UDim2.new(1, 0, 1, 0)
    Tab.Content.BackgroundTransparency = 1
    Tab.Content.Visible = false
    Tab.Content.Parent = self.ContentScroller
    
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 10)
    ContentLayout.Parent = Tab.Content
    
    -- Button Events
    Tab.Button.MouseButton1Click:Connect(function()
        self:SwitchTab(Tab)
    end)
    
    Tab.Button.MouseEnter:Connect(function()
        if Tab ~= self.CurrentTab then
            Tween(Tab.Button, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Border})
        end
    end)
    
    Tab.Button.MouseLeave:Connect(function()
        if Tab ~= self.CurrentTab then
            Tween(Tab.Button, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary})
        end
    end)
    
    self.Tabs[TabName] = Tab
    
    -- Set as current if first tab
    if not self.CurrentTab then
        self:SwitchTab(Tab)
    end
    
    return Tab
end

function HI:SwitchTab(Tab)
    -- Deactivate all tabs
    for Name, T in pairs(self.Tabs) do
        T.Content.Visible = false
        Tween(T.Button, {
            BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary,
            TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
        })
    end
    
    -- Activate selected tab
    Tab.Content.Visible = true
    Tween(Tab.Button, {
        BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Accent,
        TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    })
    
    self.CurrentTab = Tab
end

-- Section Creation (like your image - minimal headers)
function HI:NewSection(Tab, SectionName)
    local Section = {}
    
    Section.Frame = Instance.new("Frame")
    Section.Frame.Name = SectionName .. "Section"
    Section.Frame.Size = UDim2.new(1, 0, 0, 40)
    Section.Frame.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Secondary
    Section.Frame.BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    Section.Frame.BorderSizePixel = HI.Config.BorderSize
    Section.Frame.ClipsDescendants = true
    Section.Frame.Parent = Tab.Content
    
    -- Minimal header like your image
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, -20, 0, 20)
    Title.Position = UDim2.new(0, 10, 0, 5)
    Title.BackgroundTransparency = 1
    Title.Text = SectionName
    Title.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Title.Font = Enum.Font.GothamSemibold
    Title.TextSize = 13
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Section.Frame
    
    Section.Content = Instance.new("Frame")
    Section.Content.Name = "Content"
    Section.Content.Size = UDim2.new(1, -20, 0, 0)
    Section.Content.Position = UDim2.new(0, 10, 0, 25)
    Section.Content.BackgroundTransparency = 1
    Section.Content.Parent = Section.Frame
    
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 8)
    ContentLayout.Parent = Section.Content
    
    -- Auto-size section
    ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        Section.Content.Size = UDim2.new(1, -20, 0, ContentLayout.AbsoluteContentSize.Y)
        Section.Frame.Size = UDim2.new(1, 0, 0, 25 + ContentLayout.AbsoluteContentSize.Y)
    end)
    
    self.Sections[SectionName] = Section
    return Section
end

-- Enhanced Slider (with format like your image "10.6/20")
function HI:NewSlider(Section, Name, Min, Max, Default, Decimals, Callback)
    local Slider = {}
    Slider.Value = Default or Min
    Decimals = Decimals or 1
    
    local Container = Instance.new("Frame")
    Container.Name = Name .. "Slider"
    Container.Size = UDim2.new(1, 0, 0, 50)
    Container.BackgroundTransparency = 1
    Container.Parent = Section.Content
    
    local Label = Instance.new("TextLabel")
    Label.Name = "Label"
    Label.Size = UDim2.new(1, 0, 0, 20)
    Label.BackgroundTransparency = 1
    Label.Text = Name
    Label.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Label.Font = HI.Config.Font
    Label.TextSize = HI.Config.TextSize
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container
    
    local ValueLabel = Instance.new("TextLabel")
    ValueLabel.Name = "ValueLabel"
    ValueLabel.Size = UDim2.new(0, 60, 0, 20)
    ValueLabel.Position = UDim2.new(1, -60, 0, 0)
    ValueLabel.BackgroundTransparency = 1
    ValueLabel.Text = Round(Slider.Value, Decimals) .. "/" .. Max
    ValueLabel.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    ValueLabel.Font = HI.Config.Font
    ValueLabel.TextSize = HI.Config.TextSize - 1
    ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
    ValueLabel.Parent = Container
    
    local SliderBackground = Instance.new("Frame")
    SliderBackground.Name = "SliderBackground"
    SliderBackground.Size = UDim2.new(1, 0, 0, 6)
    SliderBackground.Position = UDim2.new(0, 0, 0, 30)
    SliderBackground.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    SliderBackground.BorderSizePixel = 0
    SliderBackground.Parent = Container
    
    local SliderFill = Instance.new("Frame")
    SliderFill.Name = "SliderFill"
    SliderFill.Size = UDim2.new((Slider.Value - Min) / (Max - Min), 0, 1, 0)
    SliderFill.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Accent
    SliderFill.BorderSizePixel = 0
    SliderFill.Parent = SliderBackground
    
    local SliderButton = Instance.new("TextButton")
    SliderButton.Name = "SliderButton"
    SliderButton.Size = UDim2.new(0, 14, 0, 14)
    SliderButton.Position = UDim2.new((Slider.Value - Min) / (Max - Min), -7, 0.5, -7)
    SliderButton.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    SliderButton.BorderSizePixel = 0
    SliderButton.Text = ""
    SliderButton.Parent = SliderBackground
    
    local function UpdateSlider(Value)
        Value = math.clamp(Value, Min, Max)
        Slider.Value = Value
        local Ratio = (Value - Min) / (Max - Min)
        
        ValueLabel.Text = Round(Value, Decimals) .. "/" .. Max
        Tween(SliderFill, {Size = UDim2.new(Ratio, 0, 1, 0)})
        Tween(SliderButton, {Position = UDim2.new(Ratio, -7, 0.5, -7)})
        
        if Callback then
            Callback(Value)
        end
    end
    
    local Dragging = false
    
    local function StartDrag()
        Dragging = true
        
        local MoveConnection = game:GetService("UserInputService").InputChanged:Connect(function(Input)
            if Dragging and Input.UserInputType == Enum.UserInputType.MouseMovement then
                local XPos = math.clamp(Input.Position.X - SliderBackground.AbsolutePosition.X, 0, SliderBackground.AbsoluteSize.X)
                local Ratio = XPos / SliderBackground.AbsoluteSize.X
                local Value = Min + (Max - Min) * Ratio
                UpdateSlider(Value)
            end
        end)
        
        local EndedConnection
        EndedConnection = game:GetService("UserInputService").InputEnded:Connect(function(Input)
            if Input.UserInputType == Enum.UserInputType.MouseButton1 then
                Dragging = false
                MoveConnection:Disconnect()
                EndedConnection:Disconnect()
            end
        end)
    end
    
    SliderButton.InputBegan:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            StartDrag()
        end
    end)
    
    SliderBackground.InputBegan:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            local XPos = math.clamp(Input.Position.X - SliderBackground.AbsolutePosition.X, 0, SliderBackground.AbsoluteSize.X)
            local Ratio = XPos / SliderBackground.AbsoluteSize.X
            local Value = Min + (Max - Min) * Ratio
            UpdateSlider(Value)
            StartDrag()
        end
    end)
    
    UpdateSlider(Slider.Value)
    return Slider
end

-- Enhanced Toggle (more compact)
function HI:NewToggle(Section, Name, Default, Callback)
    local Toggle = {}
    Toggle.Value = Default or false
    
    local Container = Instance.new("Frame")
    Container.Name = Name .. "Toggle"
    Container.Size = UDim2.new(1, 0, 0, 25)
    Container.BackgroundTransparency = 1
    Container.Parent = Section.Content
    
    local Label = Instance.new("TextLabel")
    Label.Name = "Label"
    Label.Size = UDim2.new(1, -50, 1, 0)
    Label.BackgroundTransparency = 1
    Label.Text = Name
    Label.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Label.Font = HI.Config.Font
    Label.TextSize = HI.Config.TextSize
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container
    
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Name = "ToggleFrame"
    ToggleFrame.Size = UDim2.new(0, 35, 0, 18)
    ToggleFrame.Position = UDim2.new(1, -40, 0.5, -9)
    ToggleFrame.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = Container
    
    local ToggleCircle = Instance.new("Frame")
    ToggleCircle.Name = "ToggleCircle"
    ToggleCircle.Size = UDim2.new(0, 14, 0, 14)
    ToggleCircle.Position = UDim2.new(0, 2, 0.5, -7)
    ToggleCircle.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    ToggleCircle.BorderSizePixel = 0
    ToggleCircle.Parent = ToggleFrame
    
    local function UpdateToggle()
        if Toggle.Value then
            Tween(ToggleFrame, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Success})
            Tween(ToggleCircle, {Position = UDim2.new(1, -16, 0.5, -7)})
        else
            Tween(ToggleFrame, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Border})
            Tween(ToggleCircle, {Position = UDim2.new(0, 2, 0.5, -7)})
        end
    end
    
    UpdateToggle()
    
    Container.InputBegan:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            Toggle.Value = not Toggle.Value
            UpdateToggle()
            
            if Callback then
                Callback(Toggle.Value)
            end
        end
    end)
    
    return Toggle
end

-- Enhanced Dropdown (compact)
function HI:NewDropdown(Section, Name, Options, Default, Callback)
    local Dropdown = {}
    Dropdown.Value = Default or Options[1]
    Dropdown.Open = false
    
    local Container = Instance.new("Frame")
    Container.Name = Name .. "Dropdown"
    Container.Size = UDim2.new(1, 0, 0, 25)
    Container.BackgroundTransparency = 1
    Container.ClipsDescendants = true
    Container.Parent = Section.Content
    
    local Label = Instance.new("TextLabel")
    Label.Name = "Label"
    Label.Size = UDim2.new(0.6, 0, 1, 0)
    Label.BackgroundTransparency = 1
    Label.Text = Name
    Label.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Label.Font = HI.Config.Font
    Label.TextSize = HI.Config.TextSize
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container
    
    local DropdownButton = Instance.new("TextButton")
    DropdownButton.Name = "DropdownButton"
    DropdownButton.Size = UDim2.new(0.35, 0, 1, 0)
    DropdownButton.Position = UDim2.new(0.65, 0, 0, 0)
    DropdownButton.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary
    DropdownButton.BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    DropdownButton.BorderSizePixel = HI.Config.BorderSize
    DropdownButton.Text = Dropdown.Value
    DropdownButton.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    DropdownButton.Font = HI.Config.Font
    DropdownButton.TextSize = HI.Config.TextSize
    DropdownButton.Parent = Container
    
    local OptionsFrame = Instance.new("Frame")
    OptionsFrame.Name = "Options"
    OptionsFrame.Size = UDim2.new(0.35, 0, 0, 0)
    OptionsFrame.Position = UDim2.new(0.65, 0, 1, 5)
    OptionsFrame.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary
    OptionsFrame.BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    OptionsFrame.BorderSizePixel = HI.Config.BorderSize
    OptionsFrame.Visible = false
    OptionsFrame.ZIndex = 10
    OptionsFrame.Parent = Container
    
    local OptionsLayout = Instance.new("UIListLayout")
    OptionsLayout.Parent = OptionsFrame
    
    -- Create Options
    for _, Option in ipairs(Options) do
        local OptionButton = Instance.new("TextButton")
        OptionButton.Name = Option
        OptionButton.Size = UDim2.new(1, 0, 0, 22)
        OptionButton.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary
        OptionButton.BorderSizePixel = 0
        OptionButton.Text = Option
        OptionButton.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
        OptionButton.Font = HI.Config.Font
        OptionButton.TextSize = HI.Config.TextSize - 1
        OptionButton.Parent = OptionsFrame
        
        OptionButton.MouseButton1Click:Connect(function()
            Dropdown.Value = Option
            DropdownButton.Text = Option
            Container.Size = UDim2.new(1, 0, 0, 25)
            Tween(OptionsFrame, {Size = UDim2.new(0.35, 0, 0, 0)})
            Dropdown.Open = false
            
            if Callback then
                Callback(Option)
            end
        end)
        
        OptionButton.MouseEnter:Connect(function()
            Tween(OptionButton, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Border})
        end)
        
        OptionButton.MouseLeave:Connect(function()
            Tween(OptionButton, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary})
        end)
    end
    
    -- Close dropdown when clicking outside
    local CloseConnection
    local function CloseDropdown()
        if Dropdown.Open then
            Container.Size = UDim2.new(1, 0, 0, 25)
            Tween(OptionsFrame, {Size = UDim2.new(0.35, 0, 0, 0)})
            Dropdown.Open = false
            if CloseConnection then
                CloseConnection:Disconnect()
            end
        end
    end
    
    -- Toggle Dropdown
    DropdownButton.MouseButton1Click:Connect(function()
        Dropdown.Open = not Dropdown.Open
        
        if Dropdown.Open then
            Container.Size = UDim2.new(1, 0, 0, 30 + #Options * 22)
            OptionsFrame.Visible = true
            OptionsFrame.Size = UDim2.new(0.35, 0, 0, #Options * 22)
            
            -- Close on click outside
            CloseConnection = game:GetService("UserInputService").InputBegan:Connect(function(Input)
                if Input.UserInputType == Enum.UserInputType.MouseButton1 then
                    local MousePos = game:GetService("Players").LocalPlayer:GetMouse()
                    if not OptionsFrame.AbsoluteRect:PointInside(MousePos) then
                        CloseDropdown()
                    end
                end
            end)
        else
            CloseDropdown()
        end
    end)
    
    return Dropdown
end

-- Enhanced Button
function HI:NewButton(Section, Name, Callback)
    local Button = Instance.new("TextButton")
    Button.Name = Name .. "Button"
    Button.Size = UDim2.new(1, 0, 0, 28)
    Button.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Accent
    Button.BorderSizePixel = 0
    Button.Text = Name
    Button.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Button.Font = Enum.Font.GothamSemibold
    Button.TextSize = HI.Config.TextSize
    Button.Parent = Section.Content
    
    Button.MouseButton1Click:Connect(function()
        if Callback then
            Callback()
        end
    end)
    
    Button.MouseEnter:Connect(function()
        Tween(Button, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Accent:Lerp(Color3.new(1, 1, 1), 0.15)})
    end)
    
    Button.MouseLeave:Connect(function()
        Tween(Button, {BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Accent})
    end)
    
    return Button
end

-- Label
function HI:NewLabel(Section, Text)
    local Label = Instance.new("TextLabel")
    Label.Name = "Label"
    Label.Size = UDim2.new(1, 0, 0, 18)
    Label.BackgroundTransparency = 1
    Label.Text = Text
    Label.TextColor3 = HI.ColorSchemes[HI.Config.Theme].SubText
    Label.Font = HI.Config.Font
    Label.TextSize = HI.Config.TextSize - 1
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Section.Content
    
    return Label
end

-- Text Box
function HI:NewTextBox(Section, Name, Placeholder, Callback)
    local Container = Instance.new("Frame")
    Container.Name = Name .. "TextBox"
    Container.Size = UDim2.new(1, 0, 0, 40)
    Container.BackgroundTransparency = 1
    Container.Parent = Section.Content
    
    local Label = Instance.new("TextLabel")
    Label.Name = "Label"
    Label.Size = UDim2.new(1, 0, 0, 20)
    Label.BackgroundTransparency = 1
    Label.Text = Name
    Label.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    Label.Font = HI.Config.Font
    Label.TextSize = HI.Config.TextSize
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container
    
    local TextBox = Instance.new("TextBox")
    TextBox.Name = "TextBox"
    TextBox.Size = UDim2.new(1, 0, 0, 22)
    TextBox.Position = UDim2.new(0, 0, 0, 20)
    TextBox.BackgroundColor3 = HI.ColorSchemes[HI.Config.Theme].Tertiary
    TextBox.BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border
    TextBox.BorderSizePixel = HI.Config.BorderSize
    TextBox.Text = ""
    TextBox.PlaceholderText = Placeholder or "Enter text..."
    TextBox.TextColor3 = HI.ColorSchemes[HI.Config.Theme].Text
    TextBox.Font = HI.Config.Font
    TextBox.TextSize = HI.Config.TextSize
    TextBox.ClearTextOnFocus = false
    TextBox.Parent = Container
    
    TextBox.Focused:Connect(function()
        Tween(TextBox, {BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Accent})
    end)
    
    TextBox.FocusLost:Connect(function()
        Tween(TextBox, {BorderColor3 = HI.ColorSchemes[HI.Config.Theme].Border})
        if Callback then
            Callback(TextBox.Text)
        end
    end)
    
    return TextBox
end

-- Show UI
function HI:Show()
    self.ScreenGui.Parent = game:GetService("CoreGui") or game.Players.LocalPlayer:WaitForChild("PlayerGui")
    self.Open = true
    self.ScreenGui.Enabled = true
    return self
end

-- Hide UI
function HI:Hide()
    self.Open = false
    self.ScreenGui.Enabled = false
    return self
end

-- Bind to key to toggle visibility
function HI:BindToKey(KeyCode)
    game:GetService("UserInputService").InputBegan:Connect(function(Input, Processed)
        if not Processed and Input.KeyCode == KeyCode then
            self:Toggle()
        end
    end)
end

-- Example setup based on your image
function HI:CreateExampleFootballUI()
    -- Create tabs like your image
    local CatchingTab = self:NewTab("Catching")
    local PhysicsTab = self:NewTab("Physics")
    local UISettingsTab = self:NewTab("UI Settings")
    
    -- Catching Tab
    local MagsSection = self:NewSection(CatchingTab, "Mags")
    self:NewSlider(MagsSection, "Range", 0, 20, 10.6, 1, function(Value)
        print("Range:", Value)
    end)
    
    local SpeedSection = self:NewSection(CatchingTab, "Speed")
    self:NewSlider(SpeedSection, "Speed Value", 0, 1.2, 1.2, 1, function(Value)
        print("Speed Value:", Value)
    end)
    
    self:NewLabel(SpeedSection, "CFrame Speed")
    
    local MagTypeSection = self:NewSection(CatchingTab, "Mag Type")
    self:NewDropdown(MagTypeSection, "Type", {"Normal", "Blatant", "FTI"}, "Blatant", function(Option)
        print("Mag Type:", Option)
    end)
    
    -- Physics Tab
    local PullSection = self:NewSection(PhysicsTab, "Pull")
    self:NewSlider(PullSection, "Pull Vector", 0, 3, 1.5, 1, function(Value)
        print("Pull Vector:", Value)
    end)
    
    self:NewSlider(PullSection, "Pull Vector Radius", 0, 25, 14.9, 1, function(Value)
        print("Pull Vector Radius:", Value)
    end)
    
    -- UI Settings Tab
    local AutoCatchSection = self:NewSection(UISettingsTab, "Auto Catch")
    self:NewSlider(AutoCatchSection, "Auto Catch Radius", 0, 25, 21.3, 1, function(Value)
        print("Auto Catch Radius:", Value)
    end)
    
    local FootballSection = self:NewSection(UISettingsTab, "Football")
    self:NewLabel(FootballSection, "Ball Path")
    
    self:NewButton(UISettingsTab, "Save Configuration", function()
        print("Configuration saved!")
    end)
    
    return self
end

return HI
